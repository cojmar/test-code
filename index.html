<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>GPS Route Tracker</title>

<!-- Leaflet CSS inline via CDN link (allowed because it's still 1 file on our side) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

<style>
  html, body { margin: 0; padding: 0; height: 100%; }
  #map { width: 100%; height: 100%; }
</style>
</head>

<body>
<div id="map"></div>

<!-- Leaflet JS from CDN (still 1 local file) -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
// --- APP START ---

const map = L.map('map').setView([0, 0], 15);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    maxZoom: 19
}).addTo(map);

let route = [];
let marker = null;
let polyline = L.polyline([], { color: "red" }).addTo(map);

if (!navigator.geolocation) {
    alert("GPS not supported");
}

navigator.geolocation.watchPosition(
    pos => {
        const { latitude, longitude } = pos.coords;

        // Save point to route
        const point = [latitude, longitude];
        route.push(point);
        polyline.setLatLngs(route);

        // Update or place marker
        if (!marker) {
            marker = L.marker(point).addTo(map);
            map.setView(point, 17);
        } else {
            marker.setLatLng(point);
        }
    },
    err => console.error(err),
    {
        enableHighAccuracy: true,
        maximumAge: 0,
        timeout: 5000
    }
);

// --- APP END ---
</script>

</body>
</html>
